{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Pr\u00e1ctica 2.2 para la instalaci\u00f3n de LAMP, certificado SSL/TLS y configurar ficheros .ssl.conf-.conf","text":""},{"location":"#descripcion","title":"Descripci\u00f3n","text":"<ul> <li>DOCUMENTO EXPLICATIVO</li> </ul>"},{"location":"Documento%20t%C3%A9cnico/","title":"Apache Pr\u00e1ctica 2.2 Certificado SSL/TLS","text":""},{"location":"Documento%20t%C3%A9cnico/#paso-1","title":"PASO 1","text":""},{"location":"Documento%20t%C3%A9cnico/#instalacion-del-conjunto-de-sofware-lamp","title":"Instalaci\u00f3n del conjunto de sofware LAMP","text":"Un script de instalaci\u00f3n de LAMP automatiza la instalaci\u00f3n y configuraci\u00f3n de los componentes esenciales de la pila LAMP (Linux, Apache, MySQL, PHP) en un sistema Linux, evitando que tengas que ejecutar manualmente cada comando. Este script realiza todas las acciones necesarias, como la actualizaci\u00f3n del sistema, la instalaci\u00f3n de paquetes, la configuraci\u00f3n de servicios.   <p>** Puedes ver el script aqu\u00ed</p> <p>DESCARGAR</p> <p>Lo comprobamos con las versiones:</p> <p></p>"},{"location":"Documento%20t%C3%A9cnico/#paso-2","title":"PASO 2","text":""},{"location":"Documento%20t%C3%A9cnico/#automatizamos-la-creacion-de-un-certificado-autofirmado-mediante-un-script","title":"Automatizamos la creaci\u00f3n de un certificado autofirmado mediante un script","text":"Un certificado autofirmado nos permite cifrar la comunicaci\u00f3n entre el cliente y el servidor, lo cual es crucial para proteger datos sensibles, especialmente en entornos de desarrollo y pruebas. Automatizar el proceso de creaci\u00f3n ahorra tiempo y esfuerzo. Al ejecutar un script, se pueden generar los archivos necesarios sin tener que realizar cada paso manualmente.   <p>** Puedes ver el script aqu\u00ed</p> <p>DESCARGAR</p> <p>Lo comprobamos: - Consultando la informaci\u00f3n del sujeto del cetificado y la fecha de caducidad</p> <p></p>"},{"location":"Documento%20t%C3%A9cnico/#paso-3","title":"PASO 3","text":""},{"location":"Documento%20t%C3%A9cnico/#configuramos-un-virtualhost-con-ssltsl-en-el-servidor-apache-mediante-un-script-combinado-que-nos-crea-las-dos-configuraciones","title":"Configuramos un VirtualHost con SSL/TSL en el servidor Apache mediante un script combinado que nos crea las dos configuraciones.","text":"<p>En nuestro caso , utilizaremos el script que nos crear\u00e1 un fichero xxx-ssl.conf en: <code>/etc/apache2/sites-available/xxx-ssl.conf</code> </p> <p>Nos habilitar\u00e1 el virtual host que acabamos de configurar y el m\u00f3dulo SSL en Apache.</p>"},{"location":"Documento%20t%C3%A9cnico/#configuramos-el-virtual-host-de-http-para-que-redirija-todo-el-trafico-a-https-con-el-mismo-script","title":"Configuramos el virtual host de HTTP para que redirija todo el tr\u00e1fico a HTTPS con el mismo script","text":"<p>En nuestro caso, el virtual host que maneja las peticiones HTTP est\u00e1 en el archivo de configuraci\u00f3n que utiliza Apache por defecto para el puerto 80  y el mismo script nos crear\u00e1 un fichero:</p> <p><code>/etc/apache2/sites-available/xxxx.conf.</code> </p> <p>El script nos habilitar\u00e1 el m\u00f3dulo rewrite en apache y reinicir\u00e1 el servicio.</p> <p>** Puedes ver el script aqu\u00ed</p> <p>DESCARGAR</p> <p>Comprobamos los sitios creados en <code>/etc/apache/sites-available</code></p> <p></p> <p>Vemos los contenidos que nos ha creado el script autom\u00e1ticamente.</p> <p> </p> <p>Comprobamos los sitios creados en <code>/etc/apache/sites-enable</code></p> <p></p> <p>Vemos el contenido que nos ha creado el script autom\u00e1ticamente.</p> <p></p>"},{"location":"Documento%20t%C3%A9cnico/#paso-4","title":"PASO 4","text":""},{"location":"Documento%20t%C3%A9cnico/#reiniciamos-el-servicio-lo-comprobamos-y-verificamos-los-puertos-que-tenemos-abiertos-en-las-reglas-de-nuestro-firewall","title":"Reiniciamos el servicio lo comprobamos y verificamos los puertos que tenemos abiertos en las reglas de nuestro firewall.","text":"<p>Borramos el index.html por default y creamos uno personalizado para hacer las pruebas.</p> <p> </p> <p>Comprobamos despu\u00e9s de volver a reiniciar Apache que podemos acceder a ella desde un navegador web.</p> <p></p>"},{"location":"Documento%20t%C3%A9cnico/#esquema-de-la-estructura-del-repositorio","title":"ESQUEMA DE LA ESTRUCTURA DEL REPOSITORIO","text":""},{"location":"Instalacion-LAMP/","title":"Instalacion LAMP","text":"<pre><code>\n\n#!/bin/bash\n\n#############################################\necho \"Script para automatizar la instalaci\u00f3n de LAMP para Debian/Ubuntu o derivados\"\necho \"Apache\"\necho \"MySQL\"\necho \"PHP\"\n\n#############################################\n#Actualizaci\u00f3n de sistema####################\n\necho \"Actualizando el sistema..\"\nsudo apt update -y &amp;&amp; sudo apt dist-upgrade -y &amp;&amp; sudo apt autoremove -y\n#Instalaci\u00f3n de Apache#######################\n\necho \"Instalando apache..\"\nsudo apt install apache2 -y\n#Instalaci\u00f3n de PHP##########################\n\necho \"Instalando PHP..\"\nsudo apt install php libapache2-mod-php php-mysql -y\n\n#Instalaci\u00f3n MySQL###########################\n\necho \"Instalando MySQL-server..\"\nsudo apt install mysql-server -y\n\n#Reinicio del servicio apache##############\n\necho \"Reiniciando apache..\"\nsudo systemctl restart apache2\n\necho \"--------------AUTOR  EDU-----------------\"\n\nexit 0\n\n</code></pre>"},{"location":"setup-certificado-firmado/","title":"Setup certificado firmado","text":"<pre><code>\n#!/bin/bash\nset -x\n\n# Configuramos las variables con los datos que necesita el certificado\nOPENSSL_COUNTRY=\"ES\"\nOPENSSL_PROVINCE=\"Valencia\"\nOPENSSL_LOCALITY=\"Tavernes de la Valldigna\"\nOPENSSL_ORGANIZATION=\"Eduardo Hern\u00e1ndez Juli\u00e1\"\nOPENSSL_ORGUNIT=\"Departamento de Informatica\"\nOPENSSL_COMMON_NAME=\"practica-https.local\"\nOPENSSL_EMAIL=\"udexeraco@hotmail.com\"\n\n# Creamos el certificado autofirmado\n\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt -subj \"/C=$OPENSSL_COUNTRY/ST=$OPENSSL_PROVINCE/L=$OPENSSL_LOCALITY/O=$OPENSSL_ORGANIZATION/OU=$OPENSSL_ORGUNIT/CN=$OPENSSL_COMMON_NAME/emailAddress=$OPENSSL_EMAIL\"\n\n</code></pre>"},{"location":"ssl-conf_.conf/","title":"Ssl conf .conf","text":"<pre><code>\n#!/bin/bash\n\n#Script para configurar un nuevo archivo en /etc/apache2/sites-available/xxx-ssl.conf\n#Script para configurar un nuevo archivo en /etc/apache2/sites-available/xxx.conf\n\n#Instalaci\u00f3n de dialog\nsudo apt install dialog -y\n\n#Funci\u00f3n para capturar el c\u00f3digo de retorno del di\u00e1logo\nfunction acabar() {\n  exit_status=$?\n  # Verificar si se seleccion\u00f3 \"Cancelar\"\n  if [ $exit_status -ne 0 ]; then\n    clear\n    echo \"Operaci\u00f3n cancelada\"\n    exit 1\n  fi\n}\n\n#Configurar ssl.conf\ndialog --title \"SSL/TSL\" \\\n  --yesno \"\u00bfQuieres crear un archivo de configuraci\u00f3n HTTPS?\" 0 0\nsino=$?\n\nif [ \"$sino\" -eq 0 ]; then\n\n  #Introducimos el nombre del fichero ssl.conf\n  nomssl=$(dialog --title \"Configuramos un nuevo /etc/apache2/sites-available/xxx-ssl.conf\" \\\n    --stdout \\\n    --inputbox \"Nombre del archivo\" 0 0)\n  #Llamo a la funcion:\n  acabar\n\n  #configuramos un nuevo ssl.conf\n  echo \"&lt;IfModule mod_ssl.c&gt;\n        &lt;VirtualHost *:443&gt;\n                #ServerName practica-https.local\n                DocumentRoot /var/www/html\n                DirectoryIndex index.php index.html\n                ErrorLog ${APACHE_LOG_DIR}/error.log\n                CustomLog ${APACHE_LOG_DIR}/access.log combined\n                SSLEngine on\n                SSLCertificateFile /etc/ssl/certs/apache-selfsigned.crt\n                SSLCertificateKeyFile /etc/ssl/private/apache-selfsigned.key\n        &lt;/VirtualHost&gt;\n&lt;/IfModule&gt;\" | sudo tee /etc/apache2/sites-available/\"$nomssl\"-ssl.conf\n\n  #Habilitamos el virtual host que acabamos de configurar.\n  sudo a2ensite \"$nomssl\"-ssl.conf\n\n  #Habilitamos el m\u00f3dulo SSL en Apache.\n  sudo a2enmod ssl\n\nfi\n\n#Configurar .conf\ndialog --title \"HTTP\" \\\n  --yesno \"\u00bfQuieres crear un archivo de configuraci\u00f3n HTTP?\" 0 0\nsino=$?\n\nif [ \"$sino\" -eq 0 ]; then\n\n  #Introducimos el nombre del fichero ssl.conf\n  nomhttp=$(dialog --title \"Configuramos un nuevo /etc/apache2/sites-available/xxx.conf\" \\\n    --stdout \\\n    --inputbox \"Nombre del archivo\" 0 0)\n  #Llamo a la funcion:\n  acabar\n\n  #configuramos un nuevo .conf\n  echo \"&lt;VirtualHost *:80&gt;\n    #ServerName practica-https.local\n    DocumentRoot /var/www/html\n    #Redirige alpuerto 443 (HTTPS)\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n    RewriteEngineOn\n    RewriteCond%{HTTPS} off\n    RewriteRule^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]\n&lt;/VirtualHost&gt;\" | sudo tee /etc/apache2/sites-available/\"$nomhttp\".conf\n\n  #Para que servidor web Apache pueda hacer redirecci\u00f3n de HTTP a HTTPS habilitamos m\u00f3dulo rewrite (Apache).\n  sudo a2enmod rewrite\n\n  #Reiniciamos el servicio de Apache\n  sudo systemctl restart apache2.service\n\n  #Comprobamos:\n  clear\n  sudo systemctl status apache2.service\n  read -p \"ENTER para continuar\"\n\nfi\n\n#Comprobar que el puerto 443 est\u00e1 abierto en las reglas del firewall para permitir el tr\u00e1fico HTTPS.\ndialog --title \"En las reglas de Firewall (sudo ufw status)\" \\\n  --msgbox \"Comprobar que el puerto 443 est\u00e1 abierto para tr\u00e1fico HTTPS\" 5 60\n\nclear\nexit 0\n\n</code></pre>"}]}